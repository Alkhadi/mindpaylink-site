<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Wellbeing â€¢ M Share</title>
  <meta name="description" content="Measured Breathing. Measurable Relief. Free, evidenceâ€‘based techniques with sharing, QR, PDF, and Buyâ€‘meâ€‘coffee." />
  <link rel="stylesheet" href="style.css" />
  <!-- Icons / PWA -->
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png" />
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0f172a" />
</head>
<body>
  <header class="site-header">
    <div class="container navbar">
      <a id="brandLink" class="brand" data-href="index.html"><span class="logo">M</span> M Share</a>
      <nav class="main-nav" id="mainNav">
        <a href="index.html" data-href="index.html" aria-current="page">Wellbeing</a>
        <a href="pdf.html" data-href="pdf.html">About</a>
        <a href="dyslexia-reading-training.html" data-href="dyslexia-reading-training.html">Dyslexia</a>
        <a href="autism.html" data-href="autism.html">Autism</a>
        <a href="depression.html" data-href="depression.html">Depression</a>
        <a href="mood.html" data-href="mood.html">Mood</a>
        <a href="contact.html" data-href="contact.html">Contact</a>
        <a href="coffee.html" data-href="coffee.html">Support Us</a>
      </nav>
      <button id="navToggle" class="nav-toggle" aria-label="Menu">â˜°</button>
    </div>
  </header>

  <main class="container">
    <div class="card">
      <h1>Measured Breathing. Measurable Relief.</h1>
      <p class="muted">
        Free, evidenceâ€‘based breathing & mindfulness techniques designed to reduce stress and anxiety in minutes.
        Track progress and keep a streak. Export a oneâ€‘page, clickable PDF of my profile to share anywhere.
      </p>
      <div class="actions">
        <a class="btn btn-success" href="box-breathing.html">ğŸŸ© Box Breathing</a>
        <a class="btn btn-success" href="4-7-8-breathing.html">ğŸŸ¦ 4â€‘7â€‘8 Breathing</a>
        <a class="btn btn-success" href="coherent-5-5.html">ğŸŸª Coherent 5â€‘5</a>
        <button id="sosBtn" class="btn btn-danger">ğŸ†˜ 60â€‘second SOS</button>
      </div>
      <div class="actions" style="margin-top:10px">
        <button id="downloadPdf" class="btn">â¬‡ Profile PDF</button>
        <a class="btn" href="pdf.html">ğŸ–¨ï¸ PDF Page</a>
        <a class="btn" href="scan.html">ğŸ“· Scan QR</a>
        <button id="saveVcf" class="btn">ğŸ‘¤ Add Contact (.vcf)</button>
      </div>
    </div>

    <div class="grid cols-3">
      <div class="card">
        <h3>Box Breathing</h3>
        <p class="muted">Square breathing (inhaleâ€“holdâ€“exhaleâ€“hold) with equal counts for pressure, resets, and focus.</p>
        <div class="badge">Stress Relief</div><div class="badge">Clarity</div><div class="badge">Performance</div>
        <div class="actions" style="margin-top:8px"><a class="btn" href="box-breathing.html">Open</a></div>
      </div>
      <div class="card">
        <h3>4â€‘7â€‘8 Breathing</h3>
        <p class="muted">Inhale 4s, hold 7s, exhale 8s. The long exhale cues the relaxation responseâ€”great for sleep.</p>
        <div class="badge">Calm</div><div class="badge">Sleep Aid</div><div class="badge">Impulse Control</div>
        <div class="actions" style="margin-top:8px"><a class="btn" href="4-7-8-breathing.html">Open</a></div>
      </div>
      <div class="card">
        <h3>Coherent 5â€‘5</h3>
        <p class="muted">In 5s, out 5s (â‰ˆ5â€“6 BPM). Resonant pace supports HRV stability and autonomic calm.</p>
        <div class="badge">HRV</div><div class="badge">Focus</div><div class="badge">Recovery</div>
        <div class="actions" style="margin-top:8px"><a class="btn" href="coherent-5-5.html">Open</a></div>
      </div>
    </div>

    <div class="card">
      <h2>Progress</h2>
      <div class="badge">Total Minutes: <span id="mTotal">0</span></div>
      <div class="badge">Streak: <span id="mStreak">0</span> days</div>
      <div class="badge">Sessions: <span id="mSessions">0</span></div>
      <div class="badge">Breaths: <span id="mBreaths">0</span></div>
      <div class="canvas-wrap" style="margin-top:10px"><canvas id="weeklyChart"></canvas></div>
      <div id="todayLine" class="today"></div>
      <div id="achWrap" style="margin-top:10px"></div>
    </div>

    <div class="card">
      <h2>Share this site</h2>
      <p class="muted">Share via link, text, PNG card, or a oneâ€‘page PDF with active links.</p>
      <div class="actions">
        <button id="shareOpen" class="btn">ğŸ”— Quick Share</button>
        <a id="scanQr" class="btn" href="scan.html">ğŸ“· Scan a QR</a>
      </div>
    </div>

    <div class="footer">Â© <span id="year"></span> info@mindpaylink.com â€” Educational only, not medical advice.</div>
  </main>

  <!-- Share sheet -->
  <div id="shareSheet" class="sheet hidden" aria-hidden="true">
    <div id="shareBackdrop" style="position:absolute; inset:0;"></div>
    <div class="sheet-card" role="dialog" aria-modal="true" aria-labelledby="shareTitle">
      <div class="sheet-head">
        <h2 id="shareTitle" class="sheet-title">Share</h2>
        <button id="shareClose" class="sheet-close" aria-label="Close">Ã—</button>
      </div>
      <textarea id="shareText" class="share-text" readonly></textarea>
      <div class="share-actions">
        <button class="btn" id="copyShare">ğŸ“‹ Copy text</button>
        <button class="btn" id="shareNative">ğŸ”— Shareâ€¦</button>
        <button class="btn" id="savePng">ğŸ–¼ï¸ Save PNG card</button>
        <button class="btn" id="sharePng">ğŸ“¤ Share PNG</button>
        <button class="btn" id="downloadPdf">â¬‡ Profile PDF</button>
        <button class="btn" id="openPdfPage">ğŸ–¨ï¸ Open PDF page</button>
        <button class="btn" id="openCoffee">ğŸ’· Buy me coffee</button>
        <button class="btn" id="saveVcf">ğŸ‘¤ Save contact (.vcf)</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    (function () {
      const { qp, Stats, drawWeeklyChart } = window.__MSHARE__ || {};
      // Year
      const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
      // Coffee CTA (ensure it exists)
      const coffeeCTA = document.getElementById('coffeeCTA');
      if (coffeeCTA) coffeeCTA.href = 'coffee.html' + (qp || '');

      // VCF + PDF actions (only if IDs are present on this page)
      const vcfBtn = document.getElementById('saveVcf');
      if (vcfBtn && window.__MSHARE__?.genVCardAndDownload) {
        vcfBtn.addEventListener('click', () => window.__MSHARE__.genVCardAndDownload());
      }
      const dlBtn = document.getElementById('downloadPdf');
      if (dlBtn && window.__MSHARE__?.quickDownloadPdf) {
        dlBtn.addEventListener('click', () => window.__MSHARE__.quickDownloadPdf());
      }

      // SOS quick route
      const sos = document.getElementById('sosBtn');
      if (sos && window.__MSHARE__?.CoachPresets) {
        sos.addEventListener('click', () => {
          const r = window.__MSHARE__.CoachPresets.panic();
          const q = new URLSearchParams(r.q);
          location.href = r.page + '?' + q.toString();
        });
      }

      // Dashboard metrics
      if (Stats) {
        const s = Stats.summary();
        const set = (id, key) => { const el = document.getElementById(id); if (el) el.textContent = s[key]; };
        set('mTotal', 'minutes'); set('mStreak', 'streak'); set('mSessions', 'sessions'); set('mBreaths', 'breaths');

        // Achievements chips
        const ach = s.ach || {};
        const wrap = document.getElementById('achWrap'); const chips = [];
        if (ach.m10) chips.push('<span class="badge ok">10+ min</span>');
        if (ach.m50) chips.push('<span class="badge ok">50+ min</span>');
        if (ach.s5) chips.push('<span class="badge ok">5+ sessions</span>');
        if (ach.b200) chips.push('<span class="badge ok">200+ breaths</span>');
        if (wrap && chips.length) wrap.innerHTML = '<div>Achievements: ' + chips.join(' ') + '</div>';

        // Progress + Today line
        if (typeof drawWeeklyChart === 'function') drawWeeklyChart('weeklyChart', 'todayLine');
      }
    })();
  </script>
</body>
</html>
